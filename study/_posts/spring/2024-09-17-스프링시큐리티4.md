---
layout: post
title:  "[Spring Security] HTTP Basic, Form Login, Custom JDBC"
date:   2024-09-17 20:43:06 +0900
categories: 
            - Study
            - spring
tags: [Spring, Spring Security]            
toc: true
related_posts:
  - study/_posts/spring/2024-09-13-ìŠ¤í”„ë§ì‹œíë¦¬í‹°1.md
  - study/_posts/spring/2024-09-15-ìŠ¤í”„ë§ì‹œíë¦¬í‹°2.md
  - study/_posts/spring/2024-09-16-ìŠ¤í”„ë§ì‹œíë¦¬í‹°3.md
---
* this unordered seed list will be replaced by the toc
{:toc}

## 5. HTTP Basic

### HTTP Basic ì¸ì¦

- RFC7617ì—ì„œ ì •ì˜ëœ ê¸°ë³¸ ì¸ì¦ ë°©ì‹
- ì‚¬ìš©ì ìê²© ì¦ëª…ì„ Base64ë¡œ ì¸ì½”ë”©í•˜ì—¬ ì„œë²„ì— ì „ì†¡í•œë‹¤.
- ê°„ë‹¨í•˜ì§€ë§Œ, ìê²© ì¦ëª…ì´ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ í‰ë¬¸ìœ¼ë¡œ ì „ì†¡ë˜ê¸° ë•Œë¬¸ì— ì•”í˜¸í™”ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œëŠ” **ë³´ì•ˆì— ì·¨ì•½**í•˜ë‹¤. â†’ HTTPSì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤.
    - HTTP ìš”ì²­ì—ì„œ Authorization í—¤ë”ì— ì‚¬ìš©ìì˜ usernameê³¼ passwordê°€ Base64ë¡œ ì¸ì½”ë”©ë˜ì–´ ì „ì†¡ëœë‹¤.
    
    ```java
    Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l
    ```
    

### **ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ë•Œ**

![image](https://github.com/user-attachments/assets/56f7a5d9-4346-423c-95eb-5ca920f406e0)

- ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ ì¸ì¦ì´ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤(ex. `/private`)ì— ì ‘ê·¼í•˜ë©´, ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ **AuthorizationFilter**ê°€ í•´ë‹¹ ìš”ì²­ì„ ê°ì§€í•˜ì—¬ **AccessDeniedException**ì„ ë°œìƒì‹œí‚¨ë‹¤.
- ì´í›„ **ExceptionTranslationFilter**ê°€ ì´ë¥¼ ì²˜ë¦¬í•˜ê³ , **BasicAuthenticationEntryPoint**ê°€ ë™ì‘í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ **WWW-Authenticate header**ë¥¼ í¬í•¨í•œ ì‘ë‹µì„ ë³´ë‚¸ë‹¤.
- í´ë¼ì´ì–¸íŠ¸ëŠ” ì´ ì‘ë‹µì„ ë°›ê³  ì‚¬ìš©ì ìê²© ì¦ëª…(username, password)ì„ ë‹¤ì‹œ ì…ë ¥í•˜ë„ë¡ ìš”ì²­ ë°›ëŠ”ë‹¤.

### ì¸ì¦ ì„±ê³µ/ì‹¤íŒ¨ ì²˜ë¦¬ íë¦„

![image](https://github.com/user-attachments/assets/84424d70-305b-47d7-9169-f418e66d6257)

- ì‚¬ìš©ìê°€ ìê²© ì¦ëª…ì„ ì…ë ¥í•˜ë©´, **BasicAuthenticationFilter**ëŠ” ì¸ì¦ì„ ìœ„í•´ **UsernamePasswordAuthenticationToken** í† í°ì„ ìƒì„±í•œë‹¤.
- ì´ í† í°ì€ **AuthenticationManager**ì—ê²Œ ì „ë‹¬ë˜ì–´ ì¸ì¦ ì²˜ë¦¬ë¥¼ ì‹œë„í•œë‹¤.
    - ì¸ì¦ ì‹¤íŒ¨ ì‹œ
        - ì‚¬ìš©ìì˜ ìê²© ì¦ëª…ì´ ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´, **SecurityContextHolder**ëŠ” ì´ˆê¸°í™”ë˜ê³ , **AuthenticationEntryPoint**ê°€ **WWW-Authenticate í—¤ë”**ë¥¼ ë‹¤ì‹œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë³´ë‚¸ë‹¤.
    - ì¸ì¦ ì„±ê³µ ì‹œ
        - ì„±ê³µí•œ ì‚¬ìš©ìì˜ ìê²© ì¦ëª… ë° ê¶Œí•œ ì •ë³´ê°€ ë‹´ê¸´ **Authentication** ê°ì²´ê°€ **SecurityContextHolder**ì— ì €ì¥ëœë‹¤.
        - ì´í›„ **BasicAuthenticationFilter**ê°€ ë‹¤ìŒ í•„í„°ë¡œ ìš”ì²­ì„ ì „ë‹¬í•œë‹¤.

### **HTTP Basic ì¸ì¦ ì„¤ì •**

- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ëŠ” ë³„ë„ì˜ ì„¤ì • ì—†ì´ë„ ê¸°ë³¸ì ìœ¼ë¡œ HTTP Basic ì¸ì¦ì„ í™œì„±í™”í•´ë‘ì—ˆë‹¤.
- ì§ì ‘ êµ¬ì„±í•˜ëŠ” ê²½ìš°, ëª…ì‹œì ìœ¼ë¡œ HTTP Basic ì¸ì¦ì„ í™œì„±í™”í•´ì•¼ í•œë‹¤.
    - SecurityConfig.java
    
    ```java
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) {
        http
            // HTTP Basic ì¸ì¦ í™œì„±í™”
            .httpBasic(withDefaults());
        return http.build();
    }
    ```
    

### HTTP Basic ì¸ì¦ ì‹¤ìŠµ

> **Security ì „ìš© ì„¤ì • íŒŒì¼ì¸ SecurityConfig.java ìƒì„±**
> 
- **SecurityConfig**
    - **@Configuration** : ìŠ¤í”„ë§ì—ì„œ ì„¤ì • í´ë˜ìŠ¤ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì• ë…¸í…Œì´ì…˜
    - **@EnableWebSecurity** : ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ê¸°ë³¸ ì„¤ì •ì„ í™œì„±í™”í•˜ëŠ” ì• ë…¸í…Œì´ì…˜
    - ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ê´€ë ¨ **ìŠ¤í”„ë§ Bean** ê°ì²´ë“¤ì„ ê´€ë¦¬í•  ë³„ë„ì˜ í´ë˜ìŠ¤
- **SecurityFilterChain**ì„ ë³„ë„ë¡œ ë“±ë¡
    - ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ê°€ ê¸°ë³¸ìœ¼ë¡œ ë™ì‘ì‹œí‚¤ëŠ” ì˜µì…˜ì´ ì•„ë‹Œ ê°œë°œìë§Œì˜ ë³„ë„ ì˜µì…˜ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•´ë‹¹ Beanì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•  ìˆ˜ ìˆë„ë¡ ë¹ˆì„ ë“±ë¡í•œë‹¤.
    - SecurityFilterChainì€ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œ í•„í„°ì²´ì¸ì„ ê´€ë¦¬í•˜ëŠ” ë¹ˆì´ë‹¤.
    - `http.httpBasic(Customizer.withDefaults())` : HTTP Basic ì¸ì¦ ë°©ì‹ì„ í™œì„±í™”í•˜ê³ , ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” formLogin ë°©ì‹ì„ ë¹„í™œì„±í™”í•œë‹¤.
    
    ```java
    @Configuration
    @EnableWebSecurity
    public class SecurityConfig {
    
        @Bean
        public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
            http.httpBasic(Customizer.withDefaults()); // HTTP Basic ì¸ì¦ ë°©ì‹ ì‚¬ìš©, formLogin ë°©ì‹ì„ ë¹„í™œì„±í™”
            
            return http.build();        
        }
    }
    ```
    

- [localhost:8080](http://localhost:8080) ì‹¤í–‰ ì‹œ
    - í™”ì´íŠ¸ë¼ë²¨ ì—ëŸ¬ í˜ì´ì§€ ë°œìƒ
    - ì¸ì¦ ê´€ë ¨ ì„¤ì •ì´ ë˜ì–´ ìˆì§€ë§Œ, ì•„ì§ ì¸ì¦ì„ ìš”êµ¬í•˜ëŠ” ê²½ë¡œì— ì ‘ê·¼í–ˆì„ ë•Œ **ë¡œê·¸ì¸ í¼ì„ ì œê³µí•˜ì§€ ì•Šê¸° ë•Œë¬¸**ì´ë‹¤.
    
    ![image](https://github.com/user-attachments/assets/f123cb9b-9a9a-4c97-a5fc-bb82a1d53dd6)
    

- **ì¸ê°€ ì¶”ê°€ ì„¤ì •**
    - `http.authorizeRequests()` : ì¸ê°€ ì„¤ì •ì„ ì‹œì‘í•œë‹¤.
    - `anyRequest().authenticated()` : ëª¨ë“  ê²½ë¡œì˜ ìš”ì²­ì— ëŒ€í•´ ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•œë‹¤.
    
    ```java
    http.authorizeRequests()
        .anyRequest()
        .authenticated(); // ëª¨ë“  ìš”ì²­ì— ëŒ€í•´ ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ í—ˆìš©
    ```
    

- ì„œë²„ ì¬ì‹¤í–‰
    
    ![image](https://github.com/user-attachments/assets/9ef96c3b-febc-4171-994d-686f57e94735)
    

- ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í™”ì´íŠ¸ë¼ë²¨ í˜ì´ì§€ ë°œìƒ
    - ì¸ì¦ì€ ì„±ê³µí–ˆìœ¼ë‚˜ ë¡œê·¸ì¸ í›„ ë¦¬ë‹¤ì´ë ‰ì…˜í•  í˜ì´ì§€ê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸
    
    ![image](https://github.com/user-attachments/assets/acdfc8c8-a699-4e8e-823e-b1ba2299e321)
    

> **ì¸ì¦ ì²˜ë¦¬ ë™ì‘ í…ŒìŠ¤íŠ¸**
> 
- `localhost:8080/hello` ì— ì ‘ì† ì‹œ, ì¸ì¦ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œëŠ” HTTP Basic ì¸ì¦ ì°½ì´ íŒì—…ë˜ë©°, ë¡œê·¸ì¸ì„ ìš”êµ¬í•œë‹¤.
    
    ![image](https://github.com/user-attachments/assets/4252fddb-ee13-4577-a578-d6f7ec28ab41)
    

- ë¡œê·¸ì¸ í›„ ë™ì‘
    - Authorization í—¤ë”ì— ì‚¬ìš©ì ì •ë³´ê°€ í¬í•¨ë˜ì–´ ëª¨ë“  ìš”ì²­ì— ëŒ€í•´ ì¸ì¦ì´ ì²˜ë¦¬ëœë‹¤.
    - ì´í›„ ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ë•Œë„ **ë™ì¼í•œ ì¸ì¦ ì •ë³´ê°€ í—¤ë”ì— í¬í•¨ëœ ìƒíƒœë¡œ ì „ì†¡**ëœë‹¤.
    - ë¬¸ì œì 
        - Authorization í—¤ë”ì— Base64ë¡œ ì¸ì½”ë”©ëœ ì‚¬ìš©ì ì •ë³´ê°€ ì§€ì†ì ìœ¼ë¡œ ì „ì†¡ë˜ê¸° ë•Œë¬¸ì— ì•ˆì „í•˜ì§€ ì•Šë‹¤.
        - ë³„ë„ì˜ ì•”í˜¸í™” ì—†ì´ ì¸ì¦ ì •ë³´ë¥¼ ë…¸ì¶œì‹œí‚¬ ìˆ˜ ìˆë‹¤.
        - ì¤‘ê°„ì— í†µì‹ ì´ ê°€ë¡œì±„ê¸°ë  ê²½ìš° ë³´ì•ˆ ìœ„í—˜ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
    
    ![image](https://github.com/user-attachments/assets/bb4820a8-8296-4285-85b1-b0dd339cdb8b)
    

> **Postman í™˜ê²½ì—ì„œ ì¸ì¦ ì²˜ë¦¬ ë™ì‘ í…ŒìŠ¤íŠ¸**
> 
- localhost:8080/hello ë¡œ ìš”ì²­ ì‹œ
    - ì¸ì¦ë˜ì§€ ì•Šì€ ìƒíƒœì´ê¸° ë•Œë¬¸ì— **401 Unauthorized** ì‘ë‹µì„ ë°›ëŠ”ë‹¤.
    - í•´ë‹¹ ë¦¬ì†ŒìŠ¤ê°€ ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •ë˜ì–´ ìˆë‹¤.
    
    ![image](https://github.com/user-attachments/assets/7091a52e-3e95-4d8a-8c43-455b149a7e54)
    

- Postmanì—ì„œ Basic Auth ì„¤ì •
    - Authorization íƒ­ì—ì„œ Typeì„ **Basic Auth** ë³€ê²½ í›„, userì™€ password ì…ë ¥í•œë‹¤.
    - ì˜¬ë°”ë¥¸ ì‚¬ìš©ì ì •ë³´ ì…ë ¥ í›„ ìš”ì²­ì„ ë³´ë‚´ë©´ **200 OK** ì‘ë‹µì„ ë°›ê³ , `/hello` ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼ì´ í—ˆìš©ëœë‹¤.
    
    ![image](https://github.com/user-attachments/assets/640e2c17-51cc-4799-9bf6-441e6518ff69)
    

> **Http ìš”ì²­ í—¤ë”ì— Authorization í—¤ë”ê°’ ì§ì ‘ ì¶”ê°€**
> 
- Postmanì—ì„œ Basic Auth ì„¤ì •ì„ ì œê±°í•˜ê³ , ìˆ˜ë™ìœ¼ë¡œ ì¸ì¦ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì´ë‹¤.
- **Base64 ì¸ì½”ë”©**
    - https://www.base64encode.org/ ì‚¬ì´íŠ¸ë¥¼ ì´ìš©í•´ `user:password` í˜•ì‹ìœ¼ë¡œ Base64ë¡œ ì¸ì½”ë”©í•œë‹¤.
    - ex. `user:12736c97-b8f5-41de-a0bb-7988be3b830e` â†’ `dXNlcjoxMjczNmM5Ny1iOGY1LTQxZGUtYTBiYi03OTg4YmUzYjgzMGU=`
- **Authorization í—¤ë” ì¶”ê°€**
    - Postmanì˜ Headers íƒ­ì—ì„œ Authorization í—¤ë”ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€í•œë‹¤.
    - ê°’ì€ **Basic ë’¤ì— Base64ë¡œ** ì¸ì½”ë”©í•œ ê°’ì„ ë¶™ì—¬ì„œ ì…ë ¥í•œë‹¤.
    - ex. `Basic dXNlcjoxMjczNmM5Ny1iOGY1LTQxZGUtYTBiYi03OTg4YmUzYjgzMGU=`
    - ìš”ì²­ ì „ì†¡ ì‹œ, í—¤ë”ì— ì˜¬ë°”ë¥¸ ì¸ì¦ ì •ë³´ê°€ í¬í•¨ë˜ì–´ **200 OK** ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆë‹¤.
    
    ![image](https://github.com/user-attachments/assets/8557ae2b-8369-4bc1-bb77-8cd3a59c4bc3)

    
- HTTP ìš”ì²­ í—¤ë”ì— ì§ì ‘ Authorization ê°’ì„ ì¶”ê°€í•˜ëŠ” ë°©ë²• â†’ ì¸ì¦ ì •ë³´ê°€ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì¸ì½”ë”©ëœ ìƒíƒœë¡œ ì „ì†¡ë˜ë¯€ë¡œ ë³´ì•ˆì´ ì·¨ì•½í•  ìˆ˜ ìˆë‹¤.
- HTTPSì™€ ê°™ì€ ë³´ì•ˆ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì•”í˜¸í™”í•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤.

## 6. Form Login ì¸ì¦

### Form ê¸°ë°˜ ì¸ì¦

- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ëŠ” HTML `<form>` íƒœê·¸ë¥¼ í†µí•´ ì‚¬ìš©ìê°€ usernameê³¼ passwordë¥¼ ì…ë ¥í•˜ì—¬ ì¸ì¦ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•œë‹¤.
    
    ```html
    <!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">
    	<head>
    		<title>Please Log In</title>
    	</head>
    	<body>
    		<h1>ë¡œê·¸ì¸</h1>
    		<form action="login" method="post">
    			<input type="text" name="username" placeholder="Username"/>
    			<input type="password" name="password" placeholder="Password"/>
    			<input type="submit" value="ë¡œê·¸ì¸" />
    		</form>
    	</body>
    </html>
    ```
    

### Form ë¡œê·¸ì¸ ì¸ì¦ ì²˜ë¦¬ íë¦„

![image](https://github.com/user-attachments/assets/804c6e7c-9857-4717-aa0f-bfd336bc8cff)


- ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ ì¸ì¦ì´ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼
    - ì¸ì¦ì´ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤(ex. `/private`)ì— ì ‘ê·¼í•˜ë©´ **AuthorizationFilter**ê°€ ìš”ì²­ì„ ê°ì§€í•˜ê³ , ì¸ì¦ë˜ì§€ ì•ŠëŠ” ê²½ìš° **AccessDeniedException**ì„ ë˜ì§„ë‹¤.
- ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    - **ExceptionTranslationFilter**ê°€ ë™ì‘í•˜ì—¬, **LoginUrlAuthenticationEntryPoint**ê°€ ì‚¬ìš©ìë¥¼ ë¡œê·¸ì¸ í˜ì´ì§€(`/login`)ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•œë‹¤.
    - ì´ ë•Œ, HTTP ì‘ë‹µ í—¤ë”ì— `Location : /login` ê°’ì„ ë‹´ì•„ ë¸Œë¼ìš°ì €ê°€ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ë„ë¡ ì•ˆë‚´í•œë‹¤.
- ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼ ë° ì¸ì¦ ì‹œë„
    - ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ usernameê³¼ passwordë¥¼ ì…ë ¥í•˜ì—¬ ì¸ì¦ ì •ë³´ë¥¼ ì„œë²„ì— ì œì¶œí•œë‹¤.
    

### Spring Security ë‚´ë¶€ ì²˜ë¦¬ íë¦„

![image](https://github.com/user-attachments/assets/4033acd3-a1cb-4f9f-bb18-464312e76843)


- ìê²© ì¦ëª… ì²˜ë¦¬
    - ì‚¬ìš©ìê°€ í¼ì— ì…ë ¥í•œ usernameê³¼ passwordëŠ” ì„œë²„ì— ì „ë‹¬ë˜ë©°, ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ **UsernamePasswordAuthenticationFilter**ì—ì„œ ì²˜ë¦¬í•œë‹¤.
    - **UsernamePasswordAuthenticationFilter**ëŠ” **HttpServletRequest** ê°ì²´ë¡œë¶€í„° ìê²© ì¦ëª… ì •ë³´ë¥¼ ì¶”ì¶œí•œ í›„, **UsernamePasswordAuthenticationToken** í† í°ì„ ìƒì„±í•œë‹¤.
- **AuthenticationManager**ì— í† í° ì „ë‹¬
    - ìƒì„±ëœ **UsernamePasswordAuthenticationToken**ì€ **AuthenticationManager**ì—ê²Œ ì „ë‹¬ë˜ì–´ ì¸ì¦ ì²˜ë¦¬ê°€ ì§„í–‰ëœë‹¤.
    - ì¸ì¦ ì„±ê³µ ì‹œ, ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ ìƒíƒœë¡œ ì „í™˜ëœë‹¤.
    - ì‹¤íŒ¨ ì‹œ, ì—ëŸ¬ë©”ì‹œì§€ë‚˜ ë¡œê·¸ì¸í•œ í˜ì´ì§€ë¡œ ë‹¤ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸ëœë‹¤.

### **Form Login í™œì„±í™”**

- ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ì„¤ì • í´ë˜ìŠ¤ì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤.
    
    ```java
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
    	http
    		.formLogin(withDefaults()); // Form Login ë°©ì‹ì„ í™œì„±í™”
    	// ì¶”ê°€ì ì¸ ì„¤ì •ë“¤...
    	return http.build();
    }
    ```
    

### Form ê¸°ë°˜ Login ì‹¤ìŠµ

- **SecurityConfig**ì—ì„œ **HttpBasic** ì¸ì¦ì„ ë¹„í™œì„±í™”í•˜ê³ , **form** ê¸°ë°˜ ë¡œê·¸ì¸ ë°©ì‹ì„ í™œì„±í™”í•œë‹¤.
    
    ```java
    // Spring Security ê´€ë ¨ ìŠ¤í”„ë§ ë¹ˆë“¤ì„ ì„¤ì •í•˜ëŠ” ì„¤ì • íŒŒì¼
    @Configuration
    @EnableWebSecurity //(debug = true)
    public class SecurityConfig {
    
        @Bean
        public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
            // HttpBasic ì¸ì¦ ë°©ì‹ ë¹„í™œì„±í™”
            // http.httpBasic(Customizer.withDefaults());
    
            // form login ë°©ì‹ í™œì„±í™”
            http.formLogin(Customizer.withDefaults());
    
            http.authorizeRequests()
                    .anyRequest()
                    .authenticated();
    
            return http.build();
        }
    }
    ```
    
    - ë””ë²„ê¹… ëª¨ë“œ í™œì„±í™”
        - `@EnableWebSecurity**(debug = true)**` ì„¤ì •ì„ ì¶”ê°€í•˜ì—¬ ë³´ì•ˆ ì„¤ì •ì˜ ë””ë²„ê¹…ì„ í™œì„±í™”í•œë‹¤.
    
    ```java
    Using generated security password: b82a5ace-2282-4520-b4f5-6a6f49d25b2e
    
    This generated password is for development use only. Your security configuration must be updated before running your application in production.
    
    2024-09-13 12:12:02.455  INFO 22536 --- [           main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@f9f3928, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@404eca05, org.springframework.security.web.context.SecurityContextPersistenceFilter@1386313f, org.springframework.security.web.header.HeaderWriterFilter@4a37191a, org.springframework.security.web.csrf.CsrfFilter@67de7a99, org.springframework.security.web.authentication.logout.LogoutFilter@2cd62003, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@593a6726, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@433c6abb, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@288f173f, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@58b91d57, org.springframework.security.web.session.SessionManagementFilter@12bbfc54, org.springframework.security.web.access.ExceptionTranslationFilter@1a0d96a5, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@6232ffdb]
    2024-09-13 12:12:02.459  WARN 22536 --- [           main] o.s.s.c.a.web.builders.WebSecurity       : 
    
    ********************************************************************
    **********        Security debugging is enabled.       *************
    **********    This may include sensitive information.  *************
    **********      Do not use in a production system!     *************
    ********************************************************************
    
    2024-09-13 12:12:02.679  INFO 22536 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
    2024-09-13 12:12:02.691  INFO 22536 --- [           main] dev.syntax.security.SecurityApplication  : Started SecurityApplication in 1.445 seconds (JVM running for 2.092)
    
    ```
    

- ì‹¤í–‰ì‹œ ë¡œê·¸
    - debug logëŠ” ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œ ì–´ë–¤ í•„í„° ì²´ì¸ì´ ì ìš©ë˜ëŠ” ì§€ ìƒì„¸í•˜ê²Œ ë³´ì—¬ì¤€ë‹¤.
    
    ```java
    2024-09-13 12:14:09.235  INFO 22536 --- [nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
    2024-09-13 12:14:09.235  INFO 22536 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
    2024-09-13 12:14:09.236  INFO 22536 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
    2024-09-13 12:14:09.244  INFO 22536 --- [nio-8080-exec-1] Spring Security Debugger                 : 
    
    ************************************************************
    
    Request received for GET '/hello':
    
    org.apache.catalina.connector.RequestFacade@be0d536
    
    servletPath:/hello
    pathInfo:null
    headers: 
    host: localhost:8080
    connection: keep-alive
    cache-control: max-age=0
    authorization: Basic dXNlcjpkMGQ3ZDRkOC1kMTY1LTRlZDQtOWQ4MC01YTIyOTJjNWI4OTU=
    sec-ch-ua: "Chromium";v="128", "Not;A=Brand";v="24", "Google Chrome";v="128"
    sec-ch-ua-mobile: ?0
    sec-ch-ua-platform: "Windows"
    upgrade-insecure-requests: 1
    user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
    accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
    sec-fetch-site: none
    sec-fetch-mode: navigate
    sec-fetch-user: ?1
    sec-fetch-dest: document
    accept-encoding: gzip, deflate, br, zstd
    accept-language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7
    cookie: JSESSIONID=CB234FCA9D9C34D960022156415AACA0
    
    Security filter chain: [
      DisableEncodeUrlFilter
      WebAsyncManagerIntegrationFilter
      SecurityContextPersistenceFilter
      HeaderWriterFilter
      CsrfFilter
      LogoutFilter
      BasicAuthenticationFilter
      RequestCacheAwareFilter
      SecurityContextHolderAwareRequestFilter
      AnonymousAuthenticationFilter
      SessionManagementFilter
      ExceptionTranslationFilter
      FilterSecurityInterceptor
    ]
    /...
    ```
    

- `UsernamePasswordAuthenticationFilter.class` íŒŒì¼ì—ì„œ ì•„ë¬´ ë©”ì„œë“œì— ë””ë²„ê·¸ ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ë¥¼ ì°ìœ¼ë©´ ë©”ì„œë“œê°€ ì‹¤í–‰ëëŠ”ì§€, ê°’ì´ ë“¤ì–´ì™”ëŠ” ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
    
    ![image](https://github.com/user-attachments/assets/0e4221c4-4286-4a85-b10d-07863eaaa5d2)

    

- ì„œë²„ ì‹¤í–‰ í›„ ë¡œê·¸ì¸ í•˜ë©´ ë””ë²„ê¹…ì´ ì‹œì‘ëœë‹¤.
    
    ![image](https://github.com/user-attachments/assets/e3e0faed-84b0-407c-9bf9-0f2404215c3e)

    

> **UserDetailsService ì»¤ìŠ¤í„°ë§ˆì´ì§•**
> 
- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” **UserDetailsService**ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ì—¬ **InMemoryUserDetailsManager**ë¡œ ì‚¬ìš©ìë¥¼ ë©”ëª¨ë¦¬ ìƒì—ì„œ ê´€ë¦¬í•˜ë„ë¡ í•œë‹¤.
    - **InMemoryUserDetailsManager** : ì„ì‹œë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤í–‰ê¸°ê°„ ë™ì•ˆë§Œ ìœ ì§€ì‹œí‚¬ ìˆ˜ ìˆë„ë¡ ë©”ëª¨ë¦¬ ìƒì—ì„œë§Œ ê´€ë¦¬í•œë‹¤.
    - ìŠ¤í”„ë§ì—ì„œ ê´€ë¦¬í•˜ëŠ” **UserDetails**ë¥¼ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸ ìš©ë„ë¡œ ì‚¬ìš©í•  User ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
    - `userDetailsService.createUser(sampleUser)` : **UserDetailsService**ì—ê²Œ í•´ë‹¹ í…ŒìŠ¤íŠ¸ Userë¥¼ ê´€ë¦¬í•˜ë„ë¡ ì¶”ê°€í•œë‹¤.
    
    ```java
        @Bean
        public UserDetailsService userDetailsService () {
            System.out.println("userDetailsService() called");
            var userDetailsService = new InMemoryUserDetailsManager();
    
            UserDetails sampleUser = User.withUsername("user1")
                    .password("1234")
                    .authorities("read")
                    .build();
    
            userDetailsService.createUser(sampleUser);
            return userDetailsService;
        }
    ```
    

- ì‹¤í–‰ ì‹œ
    - UserDetailsServiceê°€ í˜¸ì¶œëœë‹¤.
    
    ```java
    2024-09-13 14:14:08.335  INFO 9444 --- [           main] dev.syntax.security.SecurityApplication  : Starting SecurityApplication using Java 11.0.24 on 3-05 with PID 9444 (C:\woori_workspace\20.spring-security\step03_form_login\build\classes\java\main started by 3-05 in C:\woori_workspace\20.spring-security\step03_form_login)
    2024-09-13 14:14:08.338  INFO 9444 --- [           main] dev.syntax.security.SecurityApplication  : No active profile set, falling back to 1 default profile: "default"
    2024-09-13 14:14:09.091  INFO 9444 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
    2024-09-13 14:14:09.098  INFO 9444 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
    2024-09-13 14:14:09.099  INFO 9444 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
    2024-09-13 14:14:09.171  INFO 9444 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
    2024-09-13 14:14:09.171  INFO 9444 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 783 ms
    userDetailsService called
    /...
    2024-09-13 14:14:09.581  INFO 9444 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
    2024-09-13 14:14:09.589  INFO 9444 --- [           main] dev.syntax.security.SecurityApplication  : Started SecurityApplication in 1.544 seconds (JVM running for 2.174)
    ```
    
    - ë¡œê·¸ì¸ì‹œ ì—ëŸ¬ê°€ ëœ¬ë‹¤.
        - ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ PasswordEncoderë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•”í˜¸í™”í•˜ê±°ë‚˜ í•´ì‹œ ì²˜ë¦¬í•˜ë„ë¡ ìš”êµ¬í•œë‹¤.
        - ê·¸ëŸ¬ë‚˜ ë³„ë„ì˜ PasswordEncoderê°€ ì„¤ì •ë˜ì§€ ì•Šìœ¼ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.
    
    ```java
    java.lang.IllegalArgumentException: There is no PasswordEncoder mapped for the id "null"
    	at org.springframework.security.crypto.password.DelegatingPasswordEncoder$UnmappedIdPasswordEncoder.matches(DelegatingPasswordEncoder.java:289) ~[spring-security-crypto-5.7.8.jar:5.7.8]
    ```
    
    - ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ **PasswordEncoder** ë¹ˆì„ ì¶”ê°€í•´ì•¼ í•œë‹¤.

- **PasswordEncoder** ì¶”ê°€
    - **NoOpPasswordEncoder** : ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•”í˜¸í™”ë‚˜ í•´ì‹œë¥¼ ì ìš©í•˜ì§€ ì•Šê³  ì¼ë°˜ í…ìŠ¤íŠ¸(í‰ë¬¸)ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ì¸ì½”ë”
        - ì´ ì¸ì½”ë”ëŠ” Deprecated ë˜ì—ˆìœ¼ë©°, ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ë³´ì•ˆìƒ ì´ìœ ë¡œ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤. (ê°œë°œ ì´ˆê¸° ë‹¨ê³„ì—ì„œë§Œ ì‚¬ìš©ëœë‹¤.)
    
    ```java
        @Bean
        public PasswordEncoder passwordEncoder() {
            return NoOpPasswordEncoder.getInstance();
        }
    ```
    
    - ë¡œê·¸ì¸ ì„±ê³µ í›„ ì‹¤í–‰í™”ë©´
    
    ![image](https://github.com/user-attachments/assets/9c65ce1c-45a6-4735-a743-8ea5ab4af9e5)
    
    - ì„¸ì…˜ í‚¤ê°’ ì œê±° ì‹œ
        - Application íƒ­ ë‚´ Cookiesì—ì„œ JSESSIONIDë¥¼ ì œê±° í›„, /hello ê²½ë¡œë¡œ ì¬ ìš”ì²­ ì‹œ, ì„¸ì…˜ í‚¤ ê°’ì´ ì œê±°ë˜ì—ˆê¸° ë•Œë¬¸ì— ìš”ì²­ í—¤ë”ì— í‚¤ ê°’ì„ ì „ì†¡í•˜ì§€ ëª»í•˜ê²Œ ëœë‹¤.
        - ì„œë²„ëŠ” ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìë¡œ ê°„ì£¼í•˜ì—¬ ë‹¤ì‹œ ë¡œê·¸ì¸ì„ ì§„í–‰í•˜ë„ë¡ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ëœë‹¤.

> **Custom UserDetails êµ¬í˜„**
> 
- **SimpleUser**
    - ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
    - ì´ í´ë˜ìŠ¤ëŠ” ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•œ **User ê°ì²´**ë¡œ í™œìš©ë˜ì–´ì•¼ í•œë‹¤.
    - **UserDetailsë¥¼ êµ¬í˜„**í•˜ì—¬ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œ ì¸ì‹í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.
    
    ```java
    public class SimpleUser **implements UserDetails** {
    
        private final String username;
        private final String password;
    
        public SimpleUser(String password, String username) {
            this.password = password;
            this.username = username;
        }
        
        @Override
        public Collection<? extends GrantedAuthority> getAuthorities() {
            return List.of();
        }
    
        @Override
        public String getPassword() {
            return this.password;
        }
    
        @Override
        public String getUsername() {
            return this.username;
        }
    
        @Override
        public boolean isAccountNonExpired() {
            return false;
        }
    
        @Override
        public boolean isAccountNonLocked() {
            return false;
        }
    
        @Override
        public boolean isCredentialsNonExpired() {
            return false;
        }
    
        @Override
        public boolean isEnabled() {
            return false;
        }
    }
    ```
    

- **UserDetailsService**ì— ì»¤ìŠ¤í…€ ì‚¬ìš©ì ë“±ë¡
    - ê°œë°œìê°€ ë§Œë“  **SimpleUser** ê°ì²´ë„ **UserDetailsService**ì— ë“±ë¡í•˜ì—¬ í•˜ë‚˜ì˜ ì‚¬ìš©ìë¡œ ê´€ë¦¬í•˜ë„ë¡ í•œë‹¤.
    
    ```java
        @Bean
        public UserDetailsService userDetailsService() {
    		    // ..
            SimpleUser sampleUser2 = new SimpleUser("user2", "1234");
            userDetailsService.createUser(sampleUser2);
    
            return userDetailsService;
        }
    ```
    

- ì •ë¦¬
    
    <aside>
    ğŸ’¡
    
    `User.withUsername("user1")`
    
    - UserëŠ” ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” íƒ€ì…
    - ê·¸ íƒ€ì…ì„ ê°€ì§€ê³  ìƒì„±í•œ ì„ì‹œ User ê³„ì •
    - org.springframework.security.core.userdetails.User íƒ€ì…
    
    `new SimpleUser("user2", "1234");` 
    
    - ê°œë°œìê°€ ì§ì ‘ ì‘ì„±í•œ User ê³„ì •
    - ëŒ€ì‹  ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œ ì¸ì‹í•  ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•´ UserDetailsë¼ëŠ” íƒ€ì…ì„ êµ¬í˜„í•œ í•˜ìœ„ í´ë˜ìŠ¤ê°€ ë˜ì–´ì•¼ í•¨
    </aside>
    

### custom jdbc ì‹¤ìŠµ

- **build.gradle**ì— `spring-boot-starter-data-jdbc`ì™€ MySQL ì—°ê²°ì„ ìœ„í•œ ì˜ì¡´ì„±ì„ ì¶”ê°€í•œë‹¤.
    
    ```java
    implementation 'org.springframework.boot:spring-boot-starter-data-jdbc'
    runtimeOnly 'com.mysql:mysql-connector-j'
    ```
    

- application.propertiesì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì„ ì„¤ì •í•œë‹¤.
    - MySQL DBì˜ URL, ì‚¬ìš©ìëª…, ë¹„ë°€ë²ˆí˜¸ë¥¼ ì§€ì •í•œë‹¤.
    
    ```java
    spring.application.name=step04_custom_jdbc
    
    # DB ì„¤ì •
    spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
    spring.datasource.url=jdbc:mysql://localhost:3306/securityauthentication?serverTimezone=UTC&characterEncoding=UTF-8
    spring.datasource.username=root
    spring.datasource.password=1234
    
    # JPA ì„¤ì •
    spring.jpa.show-sql=true
    spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect
    spring.jpa.hibernate.ddl-auto=none
    ```
    
- DB ìƒì„± ë° ë°ì´í„° ì¶”ê°€
    - ì‚¬ìš©ìì™€ ê¶Œí•œ í…Œì´ë¸”ì„ ìƒì„±í•˜ê³  ì´ˆê¸° ë°ì´í„°ë¥¼ ì‚½ì…í•œë‹¤.
    
    ![image](https://github.com/user-attachments/assets/c766b311-5c73-4303-8f7b-f69c406dd9da)
    
    - ì´ˆê¸° ë°ì´í„°
    
    ```java
    CREATE TABLE IF NOT EXISTS `securityauthentication`.`users` (
                                                                    `id` INT NOT NULL AUTO_INCREMENT,
                                                                    `username` VARCHAR(45) NULL,
        `password` VARCHAR(45) NULL,
        `enabled` INT NOT NULL,
        PRIMARY KEY (`id`));
    
    CREATE TABLE IF NOT EXISTS `securityauthentication`.`authorities` (
                                                                          `id` INT NOT NULL AUTO_INCREMENT,
                                                                          `username` VARCHAR(45) NULL,
        `authority` VARCHAR(45) NULL,
        PRIMARY KEY (`id`));
    
    INSERT INTO `securityauthentication`.`authorities` VALUES (NULL, 'gugu', 'write');
    INSERT INTO `securityauthentication`.`users` VALUES (NULL, 'gugu', '1234', '1');
    ```
    

- user ë°ì´í„° í™•ì¸
    - ì•„ë˜ë¡œ ë¡œê·¸ì¸ í•´ë³´ì.
    
    ![image](https://github.com/user-attachments/assets/ea04f752-ade3-4a7c-a8e7-cd87dced6e7b)
    

> **JDBC ê¸°ë°˜ ì‚¬ìš©ì ì¡°íšŒ ì„¤ì •**
> 
- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì—ì„œ ì‚¬ìš©ì ì •ë³´ë¥¼ DBì—ì„œ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ **JdbcUserDetailsManager**ë¥¼ ì„¤ì •í•œë‹¤.
    - JDBC ê¸°ë°˜ìœ¼ë¡œ DBì—ì„œ ì‚¬ìš©ì ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„ì²´ë¥¼ ì§€ì •í•œë‹¤.
    - ì˜¤ë¥˜ ë°œìƒ â†’ **DataSource**ë¥¼ **JdbcUserDetailsManager**ì— ì—°ê²°í•˜ì—¬ JDBC ê¸°ë°˜ì˜ ì‚¬ìš©ì ì¡°íšŒ ê¸°ëŠ¥ì„ í™œì„±í™”í•´ì•¼í•œë‹¤.
    
    ```java
        @Bean
        public UserDetailsService userDetailsService() {
    
            JdbcUserDetailsManager jdbcUserDetailsManager = new JdbcUserDetailsManager();
    
            return jdbcUserDetailsManager;
        }
    ```
    

- **DataSource** ì¶”ê°€
    - ì•„ë˜ ì„¤ì •ìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ë¥¼ JDBC ê¸°ë°˜ìœ¼ë¡œ ì¡°íšŒí•˜ì—¬ ë¡œê·¸ì¸ì´ ê°€ëŠ¥í•˜ê²Œ ëœë‹¤.
    
    ```java
        @Bean
        public UserDetailsService userDetailsService(DataSource dataSource) {
            JdbcUserDetailsManager jdbcUserDetailsManager = new JdbcUserDetailsManager(dataSource);
    
            return jdbcUserDetailsManager;
        }
    ```
    
    - `[gugu, 1234]`ë¡œ ë¡œê·¸ì¸ í•˜ë©´ ì‹¤í–‰ëœë‹¤!

> **ì»¤ìŠ¤í…€ ë¡œê·¸ì¸ í˜ì´ì§€ ì‚¬ìš©í•˜ê¸°**
> 

<aside>
â“

**ìš”êµ¬ì‚¬í•­
-** NoOpPasswordEncoderê°€ ì•„ì˜ˆ ì‚¬ë¼ì ¸ì„œ ëª»ì“°ê²Œ ë˜ì—ˆìŒ
- í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ëŠ” í‰ë¬¸ìœ¼ë¡œ ì €ì¥ì´ ë˜ì–´ ìˆìŒ
- ë³„ë„ì˜ ì•”í˜¸í™” ì—†ì´ ê·¸ëƒ¥ í‰ë¬¸ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê²€ì¦í•  ìˆ˜ ìˆëŠ” **PlainTextPasswordEncoder**ë¼ëŠ” ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ ìƒì„±í•˜ê³ , Beanìœ¼ë¡œ ë“±ë¡, ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸

- jspë‚˜ íƒ€ì„ë¦¬í”„ì²˜ëŸ¼ ì„œë²„ì—ì„œ ë Œë”ë§í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ Get ìš”ì²­ custom/login ê²½ë¡œë¡œ ìš”ì²­ ì‹œ, ë‚´ê°€ ë§Œë“  login.htmlë¡œ ë¡œê·¸ì¸ í˜ì´ì§€ê°€ ë™ì‘í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„

`@Beanpublic 
PasswordEncoder passwordEncoder() {
    return NoOpPasswordEncoder.*getInstance*();}`

</aside>

- **PlainTextPasswordEncoder** ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ ìƒì„±
    - ê¸°ì¡´ **PasswordEncoder** ì°¸ì¡°
    
    ```java
    package dev.syntax.security.encoder;
    
    import org.springframework.security.crypto.password.PasswordEncoder;
    
    public class PlainTextPasswordEncoder implements PasswordEncoder {
        private static final PasswordEncoder INSTANCE = new PlainTextPasswordEncoder();
    
        public String encode(CharSequence rawPassword) {
            return rawPassword.toString();
        }
    
        public boolean matches(CharSequence rawPassword, String encodedPassword) {
            return rawPassword.toString().equals(encodedPassword);
        }
    
        public static PasswordEncoder getInstance() { return INSTANCE; }
    }
    ```
    
    - **SecurityConfig**ì—ì„œ **passwordEncoder**ë¥¼ **PlainTextPasswordEncoderë¡œ**  ë³€ê²½í•œë‹¤.
    
    ```java
        @Bean
        public PasswordEncoder passwordEncoder() {
            return PlainTextPasswordEncoder.getInstance();
        }
    ```
    

- **ì§ì ‘ ë§Œë“  login.html**
    - Thymeleafë¥¼ ì‚¬ìš©í•´ í¼ì„ ìƒì„±í•˜ê³ , `/login`ìœ¼ë¡œ **POST** ìš”ì²­ì„ ë³´ë‚¸ë‹¤.
    
    ```java
    <!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">
    <head>
        <title>Please Log In</title>
    </head>
    <body>
    <h1>Please Log In</h1>
    <div th:if="${param.error}">
        Invalid username and password.</div>
    <div th:if="${param.logout}">
        You have been logged out.</div>
    <form th:action="@{/login}" method="post">
        <div>
            <input type="text" name="username" placeholder="Username"/>
        </div>
        <div>
            <input type="password" name="password" placeholder="Password"/>
        </div>
        <input type="submit" value="Log in" />
    </form>
    </body>
    </html>
    ```
    
- **SecurityConfig**ì˜ **filterChain** ìˆ˜ì •
    - ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ë¡œê·¸ì¸ í˜ì´ì§€ ëŒ€ì‹ , ì§ì ‘ ë§Œë“  ë¡œê·¸ì¸ í˜ì´ì§€ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ **SecurityFilterChain**ì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤.
    
    ```java
        @Bean
        public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
            http.formLogin(form -> form
                    .loginPage("/login")
                    .permitAll());
    
            http.authorizeRequests()
                    .anyRequest()
                    .authenticated();
    
            return http.build();
        }
        
        //...
        
        @Bean
        public PasswordEncoder passwordEncoder() {
            return PlainTextPasswordEncoder.getInstance();
        }
    ```
    

- **LoginController** ì¶”ê°€
    - ì»¤ìŠ¤í…€ ë¡œê·¸ì¸ í˜ì´ì§€ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•œ **LoginController**ë¥¼ ì‘ì„±í•œë‹¤.
    - `login()` : `/login` ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ë¡œê·¸ì¸ í˜ì´ì§€(`login.html`)ë¥¼ ë Œë”ë§ì‹œí‚¬ í•¸ë“¤ëŸ¬ ë©”ì„œë“œ
    
    ```java
    @Controller
    public class LoginController {
        @GetMapping("/login")
        String login() {
            return "login";
        }
    }
    ```
    

- **build.gradle**ì— thymeleaf ì˜ì¡´ì„± ì¶”ê°€
    
    ```java
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    ```
    

- ì‹¤í–‰ ì‹œ
    - `localhost:8080`ìœ¼ë¡œ ì ‘ì†ì‹œ `localhost:8080/login`ìœ¼ë¡œ ì´ë™í•œë‹¤.
    
    ![image](https://github.com/user-attachments/assets/26dcedcb-c13a-4182-87fe-49ae2c1e2cd2)
    
    - ë¡œê·¸ì¸ ì„±ê³µ ì‹œ
    
    ![image](https://github.com/user-attachments/assets/42bd9e59-5a6f-4aa2-bc15-a7e45b380bdd)
    
    - ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ

    ![image](https://github.com/user-attachments/assets/b88a9b12-3be4-4e19-adb8-35697c4d81cb)

<br>
<br>
<br>

<blockquote>ìš°ë¦¬ FISA ìˆ˜ì—…ì„ ì°¸ê³ í•˜ì˜€ìŠµë‹ˆë‹¤.</blockquote>










  

  


